<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" type="text/css"?>
<svg id="graph-497" width="100%" xmlns="http://www.w3.org/2000/svg" class="flowchart" style="overflow: hidden; max-width: 100%; touch-action: none; user-select: none; -webkit-user-drag: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);" role="graphics-document document" aria-roledescription="flowchart-v2" height="100%" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events"><g id="viewport-20250817100212425" class="svg-pan-zoom_viewport" transform="matrix(0.5350677644884264,0,0,0.5350677644884264,-958.1105740556046,165.04886605717448)" style="transform: matrix(0.535068, 0, 0, 0.535068, -958.111, 165.049);"><style>#graph-497{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#graph-497 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#graph-497 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#graph-497 .error-icon{fill:#552222;}#graph-497 .error-text{fill:#552222;stroke:#552222;}#graph-497 .edge-thickness-normal{stroke-width:1px;}#graph-497 .edge-thickness-thick{stroke-width:3.5px;}#graph-497 .edge-pattern-solid{stroke-dasharray:0;}#graph-497 .edge-thickness-invisible{stroke-width:0;fill:none;}#graph-497 .edge-pattern-dashed{stroke-dasharray:3;}#graph-497 .edge-pattern-dotted{stroke-dasharray:2;}#graph-497 .marker{fill:#333333;stroke:#333333;}#graph-497 .marker.cross{stroke:#333333;}#graph-497 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#graph-497 p{margin:0;}#graph-497 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#graph-497 .cluster-label text{fill:#333;}#graph-497 .cluster-label span{color:#333;}#graph-497 .cluster-label span p{background-color:transparent;}#graph-497 .label text,#graph-497 span{fill:#333;color:#333;}#graph-497 .node rect,#graph-497 .node circle,#graph-497 .node ellipse,#graph-497 .node polygon,#graph-497 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#graph-497 .rough-node .label text,#graph-497 .node .label text,#graph-497 .image-shape .label,#graph-497 .icon-shape .label{text-anchor:middle;}#graph-497 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#graph-497 .rough-node .label,#graph-497 .node .label,#graph-497 .image-shape .label,#graph-497 .icon-shape .label{text-align:center;}#graph-497 .node.clickable{cursor:pointer;}#graph-497 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#graph-497 .arrowheadPath{fill:#333333;}#graph-497 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#graph-497 .flowchart-link{stroke:#333333;fill:none;}#graph-497 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#graph-497 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#graph-497 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#graph-497 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#graph-497 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#graph-497 .cluster text{fill:#333;}#graph-497 .cluster span{color:#333;}#graph-497 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#graph-497 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#graph-497 rect.text{fill:none;stroke-width:0;}#graph-497 .icon-shape,#graph-497 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#graph-497 .icon-shape p,#graph-497 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#graph-497 .icon-shape rect,#graph-497 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#graph-497 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#graph-497 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#graph-497 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="graph-497_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="graph-497_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="graph-497_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="graph-497_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="graph-497_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="graph-497_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"><g class="cluster" id="Home_LAN" data-look="classic"><rect style="" x="2787.3828125" y="114" width="310" height="252"></rect><g class="cluster-label" transform="translate(2889.41015625, 114)"><foreignObject width="105.9453125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Home Network</p></span></div></foreignObject></g></g><g class="cluster" id="Exit_Node" data-look="classic"><rect style="" x="1666.6484375" y="137" width="1070.734375" height="229"></rect><g class="cluster-label" transform="translate(2102.015625, 137)"><foreignObject width="200" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Tailscale Exit Node (at home)</p></span></div></foreignObject></g></g><g class="cluster" id="Tailscale_Network" data-look="classic"><rect style="" x="1306.6484375" y="172" width="310" height="148"></rect><g class="cluster-label" transform="translate(1364.67578125, 172)"><foreignObject width="193.9453125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Tailscale Mesh (WireGuard)</p></span></div></foreignObject></g></g><g class="cluster" id="OPi" data-look="classic"><rect style="" x="335.6484375" y="8" width="921" height="456"></rect><g class="cluster-label" transform="translate(735.8671875, 8)"><foreignObject width="120.5625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Orange Pi Router</p></span></div></foreignObject></g></g><g class="cluster" id="USB_Client" data-look="classic"><rect style="" x="5.3828125" y="247" width="208" height="196"></rect><g class="cluster-label" transform="translate(9.3828125, 247)"><foreignObject width="200" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>USB Client (e.g., laptop/phone)</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M162.024,377L170.148,381.167C178.271,385.333,194.518,393.667,213.049,397.833C231.579,402,252.393,402,273.207,402C294.021,402,314.835,402,328.742,402C342.648,402,349.648,402,353.148,402L356.648,402" id="L_UCIP_DNSMASQ_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M162.024,323L170.148,318.833C178.271,314.667,194.518,306.333,213.049,302.167C231.579,298,252.393,298,273.207,298C294.021,298,314.835,298,329.611,298C344.387,298,353.125,298,357.494,298L361.863,298" id="L_UCIP_USB0_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M568.098,298L573.133,298C578.169,298,588.241,298,596.777,298C605.313,298,612.313,298,615.813,298L619.313,298" id="L_USB0_NF_FILTER_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M883.313,259.187L890.674,256.989C898.035,254.791,912.758,250.396,931.015,248.198C949.272,246,971.064,246,981.96,246L992.855,246" id="L_NF_FILTER_TS0_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M883.313,336.813L890.674,339.011C898.035,341.209,912.758,345.604,933.932,347.802C955.105,350,982.73,350,996.543,350L1010.355,350" id="L_NF_FILTER_WLAN0_0" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M1206.441,246L1214.809,246C1223.177,246,1239.913,246,1252.447,246C1264.982,246,1273.315,246,1281.648,246C1289.982,246,1298.315,246,1305.982,246C1313.648,246,1320.648,246,1324.148,246L1327.648,246" id="L_TS0_TS_TUN_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M1591.648,246L1595.815,246C1599.982,246,1608.315,246,1616.648,246C1624.982,246,1633.315,246,1641.648,246C1649.982,246,1658.315,246,1665.982,246C1673.648,246,1680.648,246,1684.148,246L1687.648,246" id="L_TS_TUN_EN_TS0_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M1904.93,246L1909.096,246C1913.263,246,1921.596,246,1929.263,246C1936.93,246,1943.93,246,1947.43,246L1950.93,246" id="L_EN_TS0_EN_FW_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M2213.195,246L2217.362,246C2221.529,246,2229.862,246,2237.529,246C2245.195,246,2252.195,246,2255.695,246L2259.195,246" id="L_EN_FW_EN_ROUTER_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M2393.46,219L2402.898,213.833C2412.335,208.667,2431.211,198.333,2464.59,193.167C2497.969,188,2545.852,188,2593.734,188C2641.617,188,2689.5,188,2717.608,188C2745.716,188,2754.049,188,2762.383,188C2770.716,188,2779.049,188,2786.716,188C2794.383,188,2801.383,188,2804.883,188L2808.383,188" id="L_EN_ROUTER_LAN_DEV_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M2393.46,273L2402.898,278.167C2412.335,283.333,2431.211,293.667,2444.148,298.833C2457.086,304,2464.086,304,2467.586,304L2471.086,304" id="L_EN_ROUTER_EN_MASQ_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path><path d="M2712.383,304L2716.549,304C2720.716,304,2729.049,304,2737.383,304C2745.716,304,2754.049,304,2762.383,304C2770.716,304,2779.049,304,2798.525,304C2818,304,2848.617,304,2863.926,304L2879.234,304" id="L_EN_MASQ_INTERNET_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#graph-497_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(273.20703125, 402)"><g class="label" transform="translate(-37.44140625, -12)"><foreignObject width="74.8828125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>DHCP/DNS</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(927.48046875, 246)"><g class="label" transform="translate(-19.16796875, -12)"><foreignObject width="38.3359375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(927.48046875, 350)"><g class="label" transform="translate(-16.31640625, -12)"><foreignObject width="32.6328125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>drop</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(2593.734375, 188)"><g class="label" transform="translate(-69.6484375, -12)"><foreignObject width="139.296875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>LAN access allowed</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-UCIP-0" transform="translate(109.3828125, 350)"><rect class="basic label-container" style="" x="-76.3828125" y="-27" width="152.765625" height="54"></rect><g class="label" style="" transform="translate(-46.3828125, -12)"><rect></rect><foreignObject width="92.765625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>192.168.64.x</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-USB0-1" transform="translate(466.98046875, 298)"><rect class="basic label-container" style="" x="-101.1171875" y="-27" width="202.234375" height="54"></rect><g class="label" style="" transform="translate(-71.1171875, -12)"><rect></rect><foreignObject width="142.234375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>usb0 (192.168.64.1)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-DNSMASQ-2" transform="translate(466.98046875, 402)"><rect class="basic label-container" style="" x="-106.33203125" y="-27" width="212.6640625" height="54"></rect><g class="label" style="" transform="translate(-76.33203125, -12)"><rect></rect><foreignObject width="152.6640625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>dnsmasq (DHCP/DNS)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-NF_FILTER-3" transform="translate(753.3125, 298)"><rect class="basic label-container" style="" x="-130" y="-75" width="260" height="150"></rect><g class="label" style="" transform="translate(-100, -60)"><rect></rect><foreignObject width="200" height="120"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>nft: table inet usb_router_filter\n- policy drop\n- allow usb* -&gt; tailscale0/tun0\n- drop usb* -&gt; wlan0</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-NF_NAT-4" transform="translate(1101.6484375, 106)"><rect class="basic label-container" style="" x="-130" y="-63" width="260" height="126"></rect><g class="label" style="" transform="translate(-100, -48)"><rect></rect><foreignObject width="200" height="96"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>nft: table ip usb_router_nat\n- MASQ 192.168.64.0/24 -&gt; tailscale0/tun0</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-TS0-5" transform="translate(1101.6484375, 246)"><rect class="basic label-container" style="" x="-104.79296875" y="-27" width="209.5859375" height="54"></rect><g class="label" style="" transform="translate(-74.79296875, -12)"><rect></rect><foreignObject width="149.5859375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>tailscale0 (100.x.y.z)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-WLAN0-6" transform="translate(1101.6484375, 350)"><rect class="basic label-container" style="" x="-87.29296875" y="-27" width="174.5859375" height="54"></rect><g class="label" style="" transform="translate(-57.29296875, -12)"><rect></rect><foreignObject width="114.5859375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>wlan0 (blocked)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-TS_TUN-7" transform="translate(1461.6484375, 246)"><rect class="basic label-container" style="" x="-130" y="-39" width="260" height="78"></rect><g class="label" style="" transform="translate(-100, -24)"><rect></rect><foreignObject width="200" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Encrypted tunnel (WireGuard)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-EN_TS0-8" transform="translate(1798.2890625, 246)"><rect class="basic label-container" style="" x="-106.640625" y="-27" width="213.28125" height="54"></rect><g class="label" style="" transform="translate(-76.640625, -12)"><rect></rect><foreignObject width="153.28125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>tailscale0 (100.a.b.c)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-EN_FW-9" transform="translate(2084.0625, 246)"><rect class="basic label-container" style="" x="-129.1328125" y="-27" width="258.265625" height="54"></rect><g class="label" style="" transform="translate(-99.1328125, -12)"><rect></rect><foreignObject width="198.265625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>ts-* filter/nat (iptables-nft)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-EN_ROUTER-10" transform="translate(2344.140625, 246)"><rect class="basic label-container" style="" x="-80.9453125" y="-27" width="161.890625" height="54"></rect><g class="label" style="" transform="translate(-50.9453125, -12)"><rect></rect><foreignObject width="101.890625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Kernel routing</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-EN_MASQ-11" transform="translate(2593.734375, 304)"><rect class="basic label-container" style="" x="-118.6484375" y="-27" width="237.296875" height="54"></rect><g class="label" style="" transform="translate(-88.6484375, -12)"><rect></rect><foreignObject width="177.296875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>NAT/MASQ to WAN + LAN</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-LAN_DEV-12" transform="translate(2942.3828125, 188)"><rect class="basic label-container" style="" x="-130" y="-39" width="260" height="78"></rect><g class="label" style="" transform="translate(-100, -24)"><rect></rect><foreignObject width="200" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>LAN devices (e.g., 192.168.1.0/24)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-INTERNET-13" transform="translate(2942.3828125, 304)"><rect class="basic label-container" style="" x="-59.1484375" y="-27" width="118.296875" height="54"></rect><g class="label" style="" transform="translate(-29.1484375, -12)"><rect></rect><foreignObject width="58.296875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Internet</p></span></div></foreignObject></g></g></g></g></g></g></svg>